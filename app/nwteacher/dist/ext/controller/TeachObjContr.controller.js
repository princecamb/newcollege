sap.ui.define(["sap/ui/core/mvc/ControllerExtension","jquery.sap.global"],function(e,jQuery){"use strict";var t;return e.extend("nwteacher.ext.controller.TeachObjContr",{override:{onInit:function(){debugger;var e=this.base.getExtensionAPI().getModel();var o=(new sap.ushell.services.UserInfo).getEmail();t=o;var n=this.getView().createId("uploadSet-uploadButton");var a=sap.ui.getCore().byId(n);if(a){console.log("Upload button ID:",a.getId())}},routing:{onBeforeBinding:async function(e){debugger;console.log("onBeforeBinding called with context:",e);if(e){console.log("Binding Context Path:",e.getPath())}else{console.log("No binding context available.");return}var t=this.base.getExtensionAPI().getModel();if(!t){console.error("Model is not available.");return}var o;if(typeof t.getServiceUrl==="function"){o=t.getServiceUrl();console.log("Service URL:",o)}else{console.error("Unable to determine the service URL.");return}this.adjustUIControls();await this.fetchAndProcessData(o)}}},adjustUIControls:function(){var e=this;setTimeout(function(){e.base.getView().findAggregatedObjects(true,function(e){return e.isA("sap.m.Button")||e.isA("sap.m.DatePicker")||e.isA("sap.m.Input")||e.isA("sap.m.TextArea")||e.isA("sap.m.ComboBox")}).forEach(function(e){var t=e.getId();console.log("Control ID: ",t);debugger;if(e.isA("sap.m.Button")&&t.includes("Save")&&e.getText().includes("Create")){e.setText("Send for approval")}if(e.isA("sap.m.Button")&&t.includes("Save")&&e.getVisible()===true){debugger;var o=this.base.getView();var n=o.findAggregatedObjects(true);var a=n.filter(function(e){return e.getId().includes("uploadSet-uploader")||e.getId().includes("uploadSet-uploadButton")});a.forEach(function(e){e.setVisible(true)});var r=n.filter(function(e){return e.getId().includes("uploadSet")});r.forEach(function(e){console.log("Control ID:",e.getId());console.log("Control Type:",e.getMetadata().getName());if(e.isA("sap.m.Button")&&e.getId().includes("deleteButton")){e.setVisible(true);e.setEnabled(true)}if(e.isA("sap.m.Button")&&e.getId().includes("editButton")){e.setVisible(true);e.setEnabled(true)}});r.forEach(function(e){try{e.setUploadEnabled(true)}catch(t){console.log("Error setting UploadEnabled to false for control: ",e.getId(),t)}})}if(e.isA("sap.m.Button")&&t.includes("Save")&&e.getVisible()===false){debugger;var o=this.base.getView();var n=o.findAggregatedObjects(true);var a=n.filter(function(e){return e.getId().includes("uploadSet-uploader")||e.getId().includes("uploadSet-uploadButton")});a.forEach(function(e){e.setVisible(false)});var r=n.filter(function(e){return e.getId().includes("uploadSet")});r.forEach(function(e){console.log("Control ID:",e.getId());console.log("Control Type:",e.getMetadata().getName());if(e.isA("sap.m.Button")&&e.getId().includes("deleteButton")){e.setVisible(false);e.setEnabled(false)}if(e.isA("sap.m.Button")&&e.getId().includes("editButton")){e.setVisible(false);e.setEnabled(false)}});r.forEach(function(e){try{e.setUploadEnabled(false)}catch(t){console.log("Error setting UploadEnabled to false for control: ",e.getId(),t)}})}if(e.isA("sap.m.Input")&&t.includes("Age")){e.setEditable(false)}}.bind(e))}.bind(e),800)},fetchAndProcessData:async function(e){var o=this;try{const t=await new Promise((t,o)=>{jQuery.ajax({url:e+"/Department",method:"GET",dataType:"json",success:function(e){t(e)},error:function(e,t,n){o(new Error(t+": "+n))}})});console.log("Fetched data:",t);if(t&&t.value){t.value.forEach(function(e){console.log("Department Name:",e.DepartmentName)})}else{console.log("No data found or invalid response format")}}catch(e){console.error("Error fetching data",e)}try{const o=await new Promise((t,o)=>{jQuery.ajax({url:e+"/AAuthorized",method:"GET",dataType:"json",success:function(e){t(e)},error:function(e,t,n){o(new Error(t+": "+n))}})});console.log("Fetched Authorization data:",o);var n;if(o&&o.value){o.value.forEach(function(e){if(e.authEmail===t){n=e.authName}})}else{console.log("No data found or invalid response format")}var a=window.location.href;var r=a.indexOf("#");var s=a.substring(r+1);var i;if(s.includes("DepartmentID")){var l=s.match(/DepartmentID='([^']+)'/);if(l&&l[1]){i=l[1]}}console.log("current url",a);console.log("sds");console.log("original hash",r);console.log("sadad",s);console.log("Department id",i);console.log("ndnd");this.base.getView().findAggregatedObjects(true,function(e){return e.isA("sap.m.Button")||e.isA("sap.m.Input")}).forEach(function(e){if(e.isA("sap.m.Button")){if(e.getId().includes("Create")||e.getId().includes("Delete")||e.getId().includes("Edit")){if(n==="MCA"&&i==="D2"||n==="Owner"){e.setEnabled(true)}else if(n==="cse"&&i==="D1"||n==="Owner"){e.setEnabled(true)}else{e.setEnabled(false)}}}else if(e.isA("sap.m.Input")&&e.getId().includes("DepartmentName")){e.setEnabled(n==="Owner")}})}catch(e){console.error("Error fetching Roll data",e)}try{var c=window.location.href;var u=c.split("#")[1];console.log(u);var d=u.match(/ttuuid=([^,]+)/)[1];console.log(d);const t=await new Promise((t,o)=>{jQuery.ajax({url:`${e}/Teacher(ttuuid=${d},IsActiveEntity=true)`,method:"GET",dataType:"json",success:function(e){t(e)},error:function(e,t,n){console.error("Error fetching role data",e,t,n);o(new Error(t+": "+n))}})});console.log(t);var f;if(t&&t.Status){console.log(t.Status);if(t.Status==="Approved"){f=t.Status;console.log("userRoleapp: ",f)}}else{console.log("No data found or invalid response format")}this.base.getView().findAggregatedObjects(true,function(e){return e.isA("sap.m.Button")}).forEach(function(e){if(e.getId().includes("Edit")||e.getId().includes("Delete")){if(f==="Approved"&&n==="Owner"){e.setVisible(true);e.setEnabled(true)}else{e.setVisible(false);e.setEnabled(false)}}})}catch(e){console.error("Error fetching role data",e)}}})});
//# sourceMappingURL=TeachObjContr.controller.js.map